/*! formstone v0.7.8 [analytics.js] 2015-07-23 | MIT License | formstone.it */

!function(a,b){"use strict";function c(){q=b.$body}function d(){n.scrollDepth&&j()}function e(){return arguments.length&&"object"!==a.type(arguments[0])?"destroy"===arguments[0]?g.apply(this):l.apply(this,arguments):f.apply(this,arguments),null}function f(b){!t&&q.length&&(t=!0,y="function"===a.type(o.ga),z="undefined"!==a.type(o.dataLayer)&&"function"===a.type(o.dataLayer.push),n=a.extend(n,b||{}),n.scrollDepth&&(j(),p.on(s.scroll,h),p.one(s.load,d)),q.on(s.click,"*["+v+"]",k))}function g(){t&&q.length&&(p.off(s.namespace),q.off(s.namespace))}function h(){r.startTimer(x,250,i)}function i(){for(var c,d=a.mediaquery("state"),e=b.$window.scrollTop()+b.windowHeight,f=0,g=1/n.scrollStops,h=g,i=1;i<=n.scrollStops;i++)c=Math.round(100*h).toString(),w[c].passed?f++:e>w[c].edge&&(w[c].passed=!0,d.minWidth&&l("ScrollDepth","MinWidth:"+d.minWidth+"px",c)),h+=g;f>=n.scrollStops&&p.off(s.scroll)}function j(){for(var a,b=q.outerHeight(),c={},d=1/n.scrollStops,e=d,f=0,g=1;g<=n.scrollStops;g++)f=parseInt(b*e),a=Math.round(100*e).toString(),c[a]={edge:"100"===a?f-10:f,passsed:w[a]?w[a].passed:!1},e+=d;w=c}function k(b){if(y||z){b.preventDefault();var c=a(this),d=c.attr("href"),e=c.data(u).split(",");for(var f in e)e.hasOwnProperty(f)&&(e[f]=a.trim(e[f]));l(e[0],e[1],e[2]||d,e[3],e[4],c)}}function l(b,c,d,e,f,g){if("function"===a.type(o.ga)){var h={hitType:"event",location:o.location,title:o.document.title};if(b&&(h.eventCategory=b),c&&(h.eventAction=c),d&&(h.eventLabel=d),e&&(h.eventValue=e),f&&(h.nonInteraction=f),"undefined"!==a.type(g)&&!g.attr("data-analytics-stop")){var i="undefined"!==a.type(g[0].href)?g[0].href:"",j=!i.match(/^mailto\:/i)&&!i.match(/^tel\:/i)&&i.indexOf(":")<0?o.location.protocol+"//"+o.location.hostname+"/"+i:i;""!==i&&(g.attr("target")?o.open(j,g.attr("target")):h[y?"hitCallback":"eventCallback"]=function(){document.location=j})}y?o.ga("send",h):z&&(h.event="gaTriggerEvent",o.dataLayer.push(h))}}var m=b.Plugin("analytics",{methods:{_setup:c,_resize:d},utilities:{_delegate:e}}),n={scrollDepth:!1,scrollStops:5},o=b.window,p=b.$window,q=null,r=m.functions,s=m.events,t=!1,u="analytics-event",v="data-"+u,w={},x=null,y=!1,z=!1}(jQuery,Formstone);